/**
 * This code was generated by v0 by Vercel.
 * @see https://v0.dev/t/oJKF4gkXCyI
 */
import { AvatarImage, AvatarFallback, Avatar } from "#components/ui/avatar.tsx";
import {
  CardTitle,
  CardDescription,
  CardHeader,
  CardContent,
  Card,
} from "#components/ui/card.tsx";
import { channels } from "#db/schema.ts";
import { db } from "#db/index.ts";
import Link from "next/link";
import { ViewCount } from "./view-count-wrapper";

export async function ChannelList() {
  const channelList = await db.select().from(channels).orderBy(channels.name);
  return (
    <div className="grid sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6 py-2 xs:px-2 sm:px-4">
      {channelList.map((channel) => {
        return (
          <Link key={channel.id} href={channel.slug}>
            <Card>
              <CardHeader className="p-4">
                <div className="flex items-center space-x-4">
                  <Avatar className="w-12 h-12">
                    <AvatarImage alt="User avatar" src={channel.avatar} />
                    <AvatarFallback>
                      {channel.name[0].toLocaleUpperCase()}
                    </AvatarFallback>
                  </Avatar>
                  <div className="space-y-1.5">
                    <CardTitle className="text-base">{channel.name}</CardTitle>
                    <CardDescription className="text-sm">
                      {channel.xHandle}
                    </CardDescription>
                  </div>
                </div>
              </CardHeader>
              <CardContent className="flex flex-col justify-between items-end gap-4 p-4">
                <p className="text-sm">{channel.description}</p>
                <ViewCount noRevalidate channelSlug={channel.slug} />
              </CardContent>
            </Card>
          </Link>
        );
      })}
    </div>
  );
}
